Y
Yval(Y)
Yval = function(Y){
Yis = rep(0,length(Y))
for(i in 1:length(Y)) {
Yis[i] = Y[i] + rnorm(length(Y))[i]
}
return(Yis)
}
Y
Yval(Y)
Yval = function(Y){
Yis = rep(0,length(Y))
for(i in 1:length(Y)) {
Yis[i] = Y[i] + rnorm(length(Y))[i]
}
return(Yis)
}
Y
Yval(Y)
a = mean(Y) - b*mean(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(X[i])
}
return(weightsX)
}
weights(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(X[i])
}
return(weightsX)
}
weights(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(X[i])
}
return(weightsX)
}
weightsX(X)
weightsX(X)
weightsX(X)
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(X[i])
}
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(Xis[i])
}
return(weightsX)
}
weightsX(X)
weightsX(Xis)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(Xis[i])
}
return(weightsX)
}
weightsX(Xis)
rm(list = ls())
rm(list = ls())
#York's regression
Y = c(176, 166, 172, 184, 179, 170, 176)
X = c(65, 55, 67, 82, 75, 65, 75)
lm(y ~ x)
plot(x,y)
#initial value of b
binit
b = binit
#stochastic variables
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xval(X)
Yval = function(Y){
Yis = rep(0,length(Y))
for(i in 1:length(Y)) {
Yis[i] = Y[i] + rnorm(length(Y))[i]
}
return(Yis)
}
Y
Yval(Y)
#compact set of four equations:
#intercept of best fit line
a = mean(Y) - b*mean(X)
#slope of best fit line
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(Xis[i])
}
return(weightsX)
}
weightsX(Xis)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
Y = c(176, 166, 172, 184, 179, 170, 176)
X = c(65, 55, 67, 82, 75, 65, 75)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
%
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xval(X)
%
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xval(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(Xis[i])
}
return(weightsX)
}
weightsX(Xis)
Xis = rep(0,length(X))
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xval(X)
weightsX = function(Xis){
wheightsX = rep(0,length(Xis))
for(i in 1:length(Xis)){
wheightsX[i] = 1/var(Xis[i])
}
return(weightsX)
}
weightsX(Xis)
wheightsX = rep(0,length(Xis))
var(Xis[i])
for(i in 1:length(Xis)){
wheightsX[i] = 1/var(Xis[i])
}
weightsX = function(Xis){
wheightsX = rep(0,length(Xis))
for(i in 1:length(Xis)){
wheightsX[i] = 1/var(Xis[i])
}
return(weightsX)
}
weightsX(Xis)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(Xis(X)[i])
}
return(weightsX)
}
weightsX(X)
Xis = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/var(Xis(X)[i])
}
return(weightsX)
}
weightsX(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/(var(Xis(X)[i])
}
return(weightsX)
}
weightsX(X)
weightsX = function(X){
wheightsX = rep(0,length(X))
for(i in 1:length(X)){
wheightsX[i] = 1/(var(Xis(X)[i]))
}
return(weightsX)
}
weightsX(X)
Xis = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
var(rnorm(1))
var(rnorm(20))
weightsX = function(Xis){
wheightsX = rep(0,length(Xis))
for(i in 1:length(Xis)){
wheightsX[i] = 1/(var(Xis[i]))
}
return(weightsX)
}
weightsX(Xis)
Xis[1]
Xis(X)[1]
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
$
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
var(Xis(X)[1])
var(Xis(X)[1])
Y = c(176, 166, 172, 184, 179, 170, 176)
X = c(65, 55, 67, 82, 75, 65, 75)
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
Xis(X)[1]
Xis(X)[1]
var(Xis(X)[1])
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = var(X[i] + rnorm(length(X))[i])
}
return(XisVar)
}
X
XVar(X)
var((X[i] + rnorm(length(X))[i]))
for(i in 1:length(X)) {
XisVar[i] = var((X[i] + rnorm(length(X))[i]))
}
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = var((X[i] + rnorm(length(X))[i]))
}
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
XVar(X)
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = var((X[i] + rnorm(length(X))[i]))
}
for(i in 1:length(X)) {
XisVar[i] = var((X[i] + rnorm(length(X))[i]))
}
var((X[i] + rnorm(length(X))[i]))
var((X[i] + rnorm(length(X))[i]))
var((X[i] + rnorm(length(X))[i])
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
X
XVar(X)
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
XisVar[i]
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
X
XVar(X)
XisVar = rep(0,length(X))
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
X
XVar(X)
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
X
XVar(X)
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
?var
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
X
XVar(X)
var((X[i] + rnorm(length(X))[i]))
Xval = function(X){
Xis = rep(0,length(X))
for(i in 1:length(X)) {
Xis[i] = X[i] + rnorm(length(X))[i]
}
return(Xis)
}
X
Xis(X)
XVar = function(X){
XisVar = rep(0,length(X))
for(i in 1:length(X)) {
XisVar[i] = 1/var((X[i] + rnorm(length(X))[i]))
}
return(XisVar)
}
X
XVar(X)
X = c(0, 0.9, 1.8, 2.6, 3.3, 4.4, 5.2, 6.1, 6.5, 7.4)
Y = c(5.9, 5.4 ,4.4 ,4.6 ,3.5, 3.7, 2.8, 2.8,2.4,1.5)
X = c(0, 0.9, 1.8, 2.6, 3.3, 4.4, 5.2, 6.1, 6.5, 7.4)
Y = c(5.9, 5.4 ,4.4 ,4.6 ,3.5, 3.7, 2.8, 2.8,2.4,1.5)
#(w_X <- c(1e+3, 1e+3, 5e+2, 8e+2, 2e+2, 8e+1, 6e+1, 2e+1, 1.8, 1))
#(w_Y <- c(1, 1.8, 4,8, 20, 20, 70, 70, 1e+2, 5e+2))
#initial value of b and tolerance level
tolerance <- as.numeric(1e-15)
format(tolerance, scientific = F)
b_ols <- function(y, x) {
fit <- lm(y ~ x)
return(as.numeric(fit$coefficients[2]))
}
b = b_ols(Y, X)
b_diff = 1
#function for single variance
#single_var <- function(x, element){
# n <- length(x)
#mu <- mean(x)
#return(1 / (n -1) * (mu - x[element])**2)
#}
#single_var(X,3)
count <- 0
X = c(0, 0.9, 1.8, 2.6, 3.3, 4.4, 5.2, 6.1, 6.5, 7.4)
Y = c(5.9, 5.4 ,4.4 ,4.6 ,3.5, 3.7, 2.8, 2.8,2.4,1.5)
#(w_X <- c(1e+3, 1e+3, 5e+2, 8e+2, 2e+2, 8e+1, 6e+1, 2e+1, 1.8, 1))
#(w_Y <- c(1, 1.8, 4,8, 20, 20, 70, 70, 1e+2, 5e+2))
#initial value of b and tolerance level
tolerance <- as.numeric(1e-15)
format(tolerance, scientific = F)
b_ols <- function(y, x) {
fit <- lm(y ~ x)
return(as.numeric(fit$coefficients[2]))
}
b = b_ols(Y, X)
b_diff = 1
#function for single variance
#single_var <- function(x, element){
# n <- length(x)
#mu <- mean(x)
#return(1 / (n -1) * (mu - x[element])**2)
#}
#single_var(X,3)
count <- 0
while (b_diff > tolerance) {
b_old <- b
X_bar <- 0
Y_bar <- 0
W_sum <- 0
alpha <- rep(0,length(X))
W <- rep(0,length(X))
w_X = rep(0,length(X))
w_Y = rep(0,length(Y))
for (i in 1:length(X)) {
# omega, Jonas hat aber gesagt: "Lass es weg"
w_X[i] = 1 /var(X)
w_Y[i] = 1 / var(Y)
alpha[i] <- sqrt(w_X[i] * w_Y[i])
W[i] <- (alpha[i]**2 / (b**2 * w_Y[i]) + w_X[i])
X_bar <- X_bar + W[i] * X[i]
Y_bar <- Y_bar + W[i] * Y[i]
W_sum <- W_sum + W[i]
}
X_bar <- X_bar / W_sum
Y_bar <- Y_bar / W_sum
Q1 <- 0
Q2 <- 0
U <- rep(0,length(X))
V <- rep(0,length(X))
beta <- rep(0,length(X))
for (i in 1:length(X)) {
U[i] <- X[i] - X_bar
V[i] <- Y[i] - Y_bar
beta[i] <- W[i] * ((U[i] / w_Y[i]) + (b * V[i] / w_X[i]))
Q1 <- Q1 + W[i] * beta[i] * V[i]
Q2 <- Q2 + W[i] * beta[i] * U[i]
}
#Q1 <- sum(W*beta*V)
#Q2 <- sum(W*beta*U)
b <- Q1 / Q2
b_diff = abs(b - b_old)
count <- count + 1
}
print(b)
b0  = Y_bar - b * X_bar
b0
tolerance <- as.numeric(1e-15)
format(tolerance, scientific = F)
b_ols <- function(y, x) {
fit <- lm(y ~ x)
return(as.numeric(fit$coefficients[2]))
}
b = b_ols(Y, X)
b = b_ols(Y, X)
b
rm(list = ls())
library(devtools)
getwd()
setwd("/Users/jonascedrodelgado/Desktop/York-Regression/York/WehrSelaska_improved.R")
setwd("/Users/jonascedrodelgado/Desktop/York-Regression/York")
getwd()
usethis::create_package(getwd())
